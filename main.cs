using Mutagen.Bethesda;
using Mutagen.Bethesda.Skyrim;
using Mutagen.Bethesda.Synthesis;
using System.Text.Json.Nodes;

namespace ReProccer;
static class Executor
{
    internal static JsonObject? Strings;
    internal static JsonObject? Rules;
    internal static List<Utils.StaticsMap>? Statics;
    internal static IPatcherState<ISkyrimMod, ISkyrimModGetter>? State;

    internal static Lazy<Config.SettingsUI> SettingsUI = new();
    internal static readonly Lazy<Config.General> General = new();

    // entry point
    public static async Task<int> Main(string[] args)
    {
        return await SynthesisPipeline.Instance
        .AddPatch<ISkyrimMod, ISkyrimModGetter>(Initialize)
        .SetAutogeneratedSettings("ReProccer Evolved", "settings/settings.json", out SettingsUI)
        .SetTypicalOpen(GameRelease.SkyrimSE, "ReProccer.esp")
        .Run(args);
    }

    // init process
    public static void Initialize(IPatcherState<ISkyrimMod, ISkyrimModGetter> patcherState)
    {
        Console.WriteLine("");

        // getting state
        State = patcherState;

        // loading strings	
        JsonNode stringsJson = Utils.Helpers.LoadJson($"{AppContext.BaseDirectory}locales", "english.jsonc", true);

        string[] jsonFiles = [.. Directory.GetFiles($"{AppContext.BaseDirectory}locales", "*.json*")
        .Where(name => !name.Contains("english.jsonc"))
        .Select(file => Path.GetFileName(file))];

        if (jsonFiles.Length > 0)
        {
            foreach (var file in jsonFiles)
            {
                JsonNode locStrings = Utils.Helpers.LoadJson($"{AppContext.BaseDirectory}locales", file);
                stringsJson = Utils.Helpers.DeepMerge(stringsJson, locStrings);
            }
        }

        Strings = stringsJson!.AsObject();

        // building rules
        var loadOrder = State.LoadOrder;

        if (!loadOrder.Any(file => file.Key.FileName.Equals("Skyrim AE Redone - Core.esm")))
        {
            throw new Exception("\n--> Skyrim AE Redone - Core.esm should be active in the load order!\n");
        }

        if (!loadOrder.Any(file => file.Key.FileName.Equals("Skyrim AE Redone - Main.esp")))
        {
            throw new Exception("\n--> The patching is only required if the Main Module is installed\n");
        }

        JsonNode rulesJson = Utils.Helpers.LoadJson($"{AppContext.BaseDirectory}rules", "_rules-basic.jsonc");

        foreach (var file in loadOrder)
        {
            if (!file.Value.Enabled || General.Value.IgnoredFiles!.Any(name => name == file.Key.FileName)) continue;

            string[] match = Directory.GetFiles($"{AppContext.BaseDirectory}rules", $"{file.Key.Name}.json*");
            if (match.Length == 0) continue;

            JsonNode pluginRules = Utils.Helpers.LoadJson($"{AppContext.BaseDirectory}rules", $"{Path.GetFileName(match[0])}", true);
            rulesJson = Utils.Helpers.DeepMerge(rulesJson, pluginRules);
        }

        JsonNode userRules = Utils.Helpers.LoadJson($"{AppContext.BaseDirectory}rules", "_rules-user.jsonc", true);
        rulesJson = Utils.Helpers.DeepMerge(rulesJson, userRules);
        Rules = rulesJson!.AsObject();

	    // parsing statics
        Statics = BuildStatics();

        // running patchers
        if (General.Value.ArmorPatcher) Patchers.Armor.Run();
    }

    private static List<Utils.StaticsMap> BuildStatics() => [
            new(Id: "ArmorScalingFactor",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|00021a72|GMST")                  ),
            new(Id: "MaxArmorRating",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|00037deb|GMST")                  ),
            new(Id: "expElementalFire",                       Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|00010d90|EXPL")               ),
            new(Id: "expElementalFrost",                      Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|00010d91|EXPL")               ),
            new(Id: "expElementalShock",                      Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|00010d92|EXPL")               ),
            new(Id: "expAshen",                               Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000876|EXPL") ),
            new(Id: "expExploding",                           Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000854|EXPL") ),
            new(Id: "charcoal",                               Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|00033760|MISC")                  ),
            new(Id: "linenWraps",                             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|00034cd6|MISC")                  ),
            new(Id: "chaurusChitin",                          Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0003ad57|MISC")                  ),
            new(Id: "dragonscale",                            Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0003ada3|MISC")                  ),
            new(Id: "dragonbone",                             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0003ada4|MISC")                  ),
            new(Id: "ingotCorundum",                          Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ad93|MISC")                  ),
            new(Id: "ingotOrichalcum",                        Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ad99|MISC")                  ),
            new(Id: "ingotEbony",                             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ad9d|MISC")                  ),
            new(Id: "ingotGold",                              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ad9e|MISC")                  ),
            new(Id: "ingotMoonstone",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ad9f|MISC")                  ),
            new(Id: "ingotQuicksilver",                       Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ada0|MISC")                  ),
            new(Id: "ingotMalachite",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ada1|MISC")                  ),
            new(Id: "ingotSilver",                            Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ace3|MISC")                  ),
            new(Id: "ingotIron",                              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ace4|MISC")                  ),
            new(Id: "ingotSteel",                             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005ace5|MISC")                  ),
            new(Id: "firewood",                               Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006f993|MISC")                  ),
            new(Id: "leatherStrips",                          Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000800e4|MISC")                  ),
            new(Id: "leather",                                Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000db5d2|MISC")                  ),
            new(Id: "ingotDwarven",                           Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000db8a2|MISC")                  ),
            new(Id: "netchLeather",                           Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|0001cd7c|MISC")              ),
            new(Id: "chitinPlate",                            Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|0002b04e|MISC")              ),
            new(Id: "oreStalhrim",                            Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|0002b06b|MISC")              ),
            new(Id: "ingotAmber",                             Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|00000bc7|MISC")     ),
            new(Id: "ingotMadness",                           Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|00000bc8|MISC")     ),
            new(Id: "pettySoulGem",                           Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0002e4e3|SLGM")                  ),
            new(Id: "lesserSoulGem",                          Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0002e4e5|SLGM")                  ),
            new(Id: "commonSoulGem",                          Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0002e4f3|SLGM")                  ),
            new(Id: "fireSalt",                               Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0003ad5e|INGR")                  ),
            new(Id: "frostSalt",                              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0003ad5f|INGR")                  ),
            new(Id: "voidSalt",                               Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0003ad60|INGR")                  ),
            new(Id: "trollFat",                               Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0003ad72|INGR")                  ),
            new(Id: "glowDust",                               Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0003ad73|INGR")                  ),
            new(Id: "sprigganSap",                            Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|00063b5f|INGR")                  ),
            new(Id: "wispWrappings",                          Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bc0e|INGR")                  ),
            new(Id: "dwarvenOil",                             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000f11c0|INGR")                  ),
            new(Id: "spawnAsh",                               Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|0001cd6d|INGR")              ),
            new(Id: "kwWeapTypeSword",                        Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e711|KWDA")                  ),
            new(Id: "kwWeapTypeWaraxe",                       Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e712|KWDA")                  ),
            new(Id: "kwWeapTypeDagger",                       Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e713|KWDA")                  ),
            new(Id: "kwWeapTypeMace",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e714|KWDA")                  ),
            new(Id: "kwWeapTypeBow",                          Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e715|KWDA")                  ),
            new(Id: "kwWeapMaterialWood",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e717|KWDA")                  ),
            new(Id: "kwWeapMaterialIron",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e718|KWDA")                  ),
            new(Id: "kwWeapMaterialSteel",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e719|KWDA")                  ),
            new(Id: "kwWeapMaterialDwarven",                  Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e71a|KWDA")                  ),
            new(Id: "kwWeapMaterialElven",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e71b|KWDA")                  ),
            new(Id: "kwWeapMaterialOrcish",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e71c|KWDA")                  ),
            new(Id: "kwWeapMaterialGlass",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e71d|KWDA")                  ),
            new(Id: "kwWeapMaterialEbony",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e71e|KWDA")                  ),
            new(Id: "kwWeapMaterialDaedric",                  Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0001e71f|KWDA")                  ),
            new(Id: "ArmorHeavy",                             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbd2|KWDA")                  ),
            new(Id: "ArmorLight",                             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbd3|KWDA")                  ),
            new(Id: "kwArmorMaterialDaedric",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbd4|KWDA")                  ),
            new(Id: "kwArmorMaterialDragonplate",             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbd5|KWDA")                  ),
            new(Id: "kwArmorMaterialDragonscale",             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbd6|KWDA")                  ),
            new(Id: "kwArmorMaterialDwarven",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbd7|KWDA")                  ),
            new(Id: "kwArmorMaterialEbony",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbd8|KWDA")                  ),
            new(Id: "kwArmorMaterialElven",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbd9|KWDA")                  ),
            new(Id: "kwArmorMaterialElvenGilded",             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbda|KWDA")                  ),
            new(Id: "kwArmorMaterialLeather",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbdb|KWDA")                  ),
            new(Id: "kwArmorMaterialGlass",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbdc|KWDA")                  ),
            new(Id: "kwArmorMaterialHide",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbdd|KWDA")                  ),
            new(Id: "kwArmorMaterialScaled",                  Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbde|KWDA")                  ),
            new(Id: "kwArmorMaterialStudded",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbdf|KWDA")                  ),
            new(Id: "kwArmorMaterialImperialLight",           Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe0|KWDA")                  ),
            new(Id: "kwArmorMaterialImperialStudded",         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe1|KWDA")                  ),
            new(Id: "kwArmorMaterialImperialHeavy",           Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe2|KWDA")                  ),
            new(Id: "kwArmorMaterialIron",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe3|KWDA")                  ),
            new(Id: "kwArmorMaterialIronBanded",              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe4|KWDA")                  ),
            new(Id: "kwArmorMaterialOrcish",                  Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe5|KWDA")                  ),
            new(Id: "kwArmorMaterialSteel",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe6|KWDA")                  ),
            new(Id: "kwArmorMaterialSteelPlate",              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe7|KWDA")                  ),
            new(Id: "ArmorClothing",                          Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe8|KWDA")                  ),
            new(Id: "ArmorJewelry",                           Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006bbe9|KWDA")                  ),
            new(Id: "kwArmorSlotCuirass",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006c0ec|KWDA")                  ),
            new(Id: "kwArmorSlotBoots",                       Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006c0ed|KWDA")                  ),
            new(Id: "kwArmorSlotHelmet",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006c0ee|KWDA")                  ),
            new(Id: "kwArmorSlotGauntlets",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006c0ef|KWDA")                  ),
            new(Id: "kwWeapTypeWarhammer",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006d930|KWDA")                  ),
            new(Id: "kwWeapTypeGreatsword",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006d931|KWDA")                  ),
            new(Id: "kwWeapTypeBattleaxe",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0006d932|KWDA")                  ),
            new(Id: "kwCraftingTanningRack",                  Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0007866a|KWDA")                  ),
            new(Id: "kwCraftingSmithingForge",                Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|00088105|KWDA")                  ),
            new(Id: "kwCraftingSmithingSharpeningWheel",      Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|00088108|KWDA")                  ),
            new(Id: "VendorItemArmor",                        Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0008f959|KWDA")                  ),
            new(Id: "VendorItemJewelry",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0008f95a|KWDA")                  ),
            new(Id: "VendorItemClothing",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0008f95b|KWDA")                  ),
            new(Id: "ArmorShield",                            Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000965b2|KWDA")                  ),
            new(Id: "kwCraftingSmelter",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000a5cce|KWDA")                  ),
            new(Id: "kwClothingBody",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000a8657|KWDA")                  ),
            new(Id: "kwArmorMaterialStormcloak",              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000ac13a|KWDA")                  ),
            new(Id: "kwCraftingSmithingArmorTable",           Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000adb78|KWDA")                  ),
            new(Id: "kwMagicDisallowEnchanting",              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000c27bd|KWDA")                  ),
            new(Id: "kwWeapMaterialImperial",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000c5c00|KWDA")                  ),
            new(Id: "kwWeapMaterialDraugr",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000c5c01|KWDA")                  ),
            new(Id: "kwWeapMaterialDraugrHoned",              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000c5c02|KWDA")                  ),
            new(Id: "kwWeapMaterialFalmer",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000c5c03|KWDA")                  ),
            new(Id: "kwWeapMaterialFalmerHoned",              Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000c5c04|KWDA")                  ),
            new(Id: "kwWeapMaterialSilver",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0010aa1a|KWDA")                  ),
            new(Id: "kwClothingHead",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0010cd11|KWDA")                  ),
            new(Id: "kwArmorMaterialNightingale",             Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0010fd61|KWDA")                  ),
            new(Id: "kwArmorMaterialDarkBrotherhood",         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0010fd62|KWDA")                  ),
            new(Id: "kwArmorMaterialBlades",                  Formkey: Utils.Helpers.ParseFormKey("Update.esm|000009c0|KWDA")                  ),
            new(Id: "kwArmorMaterialForsworn",                Formkey: Utils.Helpers.ParseFormKey("Update.esm|000009b9|KWDA")                  ),
            new(Id: "kwArmorMaterialThievesGuild",            Formkey: Utils.Helpers.ParseFormKey("Update.esm|000009bc|KWDA")                  ),
            new(Id: "kwArmorMaterialBearStormcloak",          Formkey: Utils.Helpers.ParseFormKey("Update.esm|000009be|KWDA")                  ),
            new(Id: "kwWAF_WeapMaterialBlades",               Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0103|KWDA")                  ),
            new(Id: "kwWAF_WeapMaterialForsworn",             Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0104|KWDA")                  ),
            new(Id: "kwWAF_ArmorWolf",                        Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0107|KWDA")                  ),
            new(Id: "kwWAF_ArmorMaterialGuard",               Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0112|KWDA")                  ),
            new(Id: "kwWAF_DLC1WeapMaterialDawnguard",        Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0116|KWDA")                  ),
            new(Id: "kwWAF_DLC1ArmorDawnguardHeavy",          Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0117|KWDA")                  ),
            new(Id: "kwWAF_DLC1ArmorDawnguardLight",          Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0118|KWDA")                  ),
            new(Id: "kwWAF_ArmorMaterialDraugr",              Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0135|KWDA")                  ),
            new(Id: "kwWAF_ArmorMaterialThalmor",             Formkey: Utils.Helpers.ParseFormKey("Update.esm|00af0222|KWDA")                  ),
            new(Id: "kwDLC1CrossbowIsEnhanced",               Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|0000399c|KWDA")               ),
            new(Id: "kwDLC1ArmorMaterialHunter",              Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|000050c4|KWDA")               ),
            new(Id: "kwDLC1CraftingDawnguard",                Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|0000f806|KWDA")               ),
            new(Id: "kwDLC1ArmorMaterialDawnguard",           Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|00012ccd|KWDA")               ),
            new(Id: "kwDLC1ArmorMaterialFalmerHardened",      Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|00012cce|KWDA")               ),
            new(Id: "kwDLC1ArmorMaterialFalmerHeavy",         Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|00012ccf|KWDA")               ),
            new(Id: "kwDLC1ArmorMaterialFalmerHeavyOriginal", Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|00012cd0|KWDA")               ),
            new(Id: "kwDLC1ArmorMaterialVampire",             Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|0001463e|KWDA")               ),
            new(Id: "kwDLC1WeapMaterialDragonbone",           Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|00019822|KWDA")               ),
            new(Id: "kwDLC2ArmorMaterialBonemoldLight",       Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00024100|KWDA")              ),
            new(Id: "kwDLC2ArmorMaterialBonemoldHeavy",       Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00024101|KWDA")              ),
            new(Id: "kwDLC2ArmorMaterialChitinLight",         Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00024102|KWDA")              ),
            new(Id: "kwDLC2ArmorMaterialChitinHeavy",         Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00024103|KWDA")              ),
            new(Id: "kwDLC2ArmorMaterialNordicLight",         Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00024104|KWDA")              ),
            new(Id: "kwDLC2ArmorMaterialNordicHeavy",         Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00024105|KWDA")              ),
            new(Id: "kwDLC2ArmorMaterialStalhrimHeavy",       Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00024106|KWDA")              ),
            new(Id: "kwDLC2ArmorMaterialStalhrimLight",       Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00024107|KWDA")              ),
            new(Id: "kwDLC2WeaponMaterialStalhrim",           Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|0002622f|KWDA")              ),
            new(Id: "kwDLC2WeaponMaterialNordic",             Formkey: Utils.Helpers.ParseFormKey("Dragonborn.esm|00026230|KWDA")              ),
            new(Id: "kwCC_ArmorMaterialGolden",               Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|0021bd63|KWDA")     ),
            new(Id: "kwCC_ArmorMaterialDark",                 Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|0021bd64|KWDA")     ),
            new(Id: "kwCC_ArmorMaterialMadness",              Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|0021bd65|KWDA")     ),
            new(Id: "kwCC_ArmorMaterialAmber",                Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|0021bd66|KWDA")     ),
            new(Id: "kwCC_WeapMaterialAmber",                 Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|0021bd67|KWDA")     ),
            new(Id: "kwCC_WeapMaterialMadness",               Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|0021bd68|KWDA")     ),
            new(Id: "kwCC_WeapMaterialGolden",                Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|0021bd69|KWDA")     ),
            new(Id: "kwCC_WeapMaterialDark",                  Formkey: Utils.Helpers.ParseFormKey("ccBGSSSE025-AdvDSGS.esm|0021bd6a|KWDA")     ),
            new(Id: "NoMeltdownRecipes",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000080e|KWDA") ),
            new(Id: "kwArmorShieldHeavy",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000080f|KWDA") ),
            new(Id: "kwArmorShieldLight",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000810|KWDA") ),
            new(Id: "kwArmorDreamcloth",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000811|KWDA") ),
            new(Id: "kwWeapTypeBastardSword",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000813|KWDA") ),
            new(Id: "kwWeapTypeQuarterstaff",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000814|KWDA") ),
            new(Id: "kwWeapMaterialBound",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000815|KWDA") ),
            new(Id: "kwWeapTypeShortbow",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000817|KWDA") ),
            new(Id: "kwWeapTypeBroadsword",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000818|KWDA") ),
            new(Id: "kwWeapTypeClub",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000819|KWDA") ),
            new(Id: "kwWeapTypeCrossbow",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000081a|KWDA") ),
            new(Id: "kwWeapTypeGlaive",                       Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000081b|KWDA") ),
            new(Id: "kwWeapTypeHalberd",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000081c|KWDA") ),
            new(Id: "kwWeapTypeHatchet",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000081d|KWDA") ),
            new(Id: "kwWeapTypeKatana",                       Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000081e|KWDA") ),
            new(Id: "kwWeapTypeLongbow",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000816|KWDA") ),
            new(Id: "kwWeapTypeLongmace",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000081f|KWDA") ),
            new(Id: "kwWeapTypeLongspear",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000820|KWDA") ),
            new(Id: "kwWeapTypeLongsword",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000821|KWDA") ),
            new(Id: "kwWeapTypeMaul",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000822|KWDA") ),
            new(Id: "kwWeapTypeNodachi",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000823|KWDA") ),
            new(Id: "kwWeapTypeScimitar",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000824|KWDA") ),
            new(Id: "kwWeapTypeShortspear",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000825|KWDA") ),
            new(Id: "kwWeapTypeShortsword",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000826|KWDA") ),
            new(Id: "kwWeapTypeTanto",                        Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000827|KWDA") ),
            new(Id: "kwWeapTypeWakizashi",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000828|KWDA") ),
            new(Id: "kwWeapMaterialSilverRefined",            Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000829|KWDA") ),
            new(Id: "kwDreamclothBody",                       Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|0000098d|KWDA") ),
            new(Id: "kwAmmoSiphon",                           Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000b8f|KWDA") ),
            new(Id: "kwAmmoBarbed",                           Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d87|KWDA") ),
            new(Id: "kwAmmoHeavy",                            Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d88|KWDA") ),
            new(Id: "kwEnhancedCrossbowMuffled",              Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d97|KWDA") ),
            new(Id: "kwEnhancedCrossbowSiege",                Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d98|KWDA") ),
            new(Id: "kwMasqueradeBandit",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000f44|KWDA") ),
            new(Id: "kwMasqueradeForsworn",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000f45|KWDA") ),
            new(Id: "kwMasqueradeImperial",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000f46|KWDA") ),
            new(Id: "kwMasqueradeStormcloak",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000f47|KWDA") ),
            new(Id: "kwMasqueradeThalmor",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000f48|KWDA") ),
            new(Id: "perkSmithingDragon",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|00052190|PERK")                  ),
            new(Id: "perkSmithingArcaneBlacksmith",           Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0005218e|PERK")                  ),
            new(Id: "perkSmithingSteel",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000cb40d|PERK")                  ),
            new(Id: "perkSmithingDwarven",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000cb40e|PERK")                  ),
            new(Id: "perkSmithingElven",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000cb40f|PERK")                  ),
            new(Id: "perkSmithingOrcish",                     Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000cb410|PERK")                  ),
            new(Id: "perkSmithingGlass",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000cb411|PERK")                  ),
            new(Id: "perkSmithingEbony",                      Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000cb412|PERK")                  ),
            new(Id: "perkSmithingDaedric",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000cb413|PERK")                  ),
            new(Id: "perkSmithingAdvanced",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|000cb414|PERK")                  ),
            new(Id: "perkSilverPerk",                         Formkey: Utils.Helpers.ParseFormKey("Skyrim.esm|0010d685|PERK")                  ),
            new(Id: "perkEnhancedCrossbow",                   Formkey: Utils.Helpers.ParseFormKey("Dawnguard.esm|0000399b|PERK")               ),
            new(Id: "perkAlchemyFuse",                        Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000851|PERK") ),
            new(Id: "perkAlchemySuffocation",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000873|PERK") ),
            new(Id: "perkMarksmanshipAdvancedFletching0",     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d84|PERK") ),
            new(Id: "perkMarksmanshipAdvancedFletching1",     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d85|PERK") ),
            new(Id: "perkMarksmanshipAdvancedFletching2",     Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d86|PERK") ),
            new(Id: "perkEnchantingElementalBombard0",        Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000b8d|PERK") ),
            new(Id: "perkEnchantingElementalBombard1",        Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000b8e|PERK") ),
            new(Id: "perkMarksmanshipBallistics",             Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d80|PERK") ),
            new(Id: "perkMarksmanshipLightweight",            Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d93|PERK") ),
            new(Id: "perkMarksmanshipRecurve",                Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d94|PERK") ),
            new(Id: "perkMarksmanshipSilencer",               Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d95|PERK") ),
            new(Id: "perkMarksmanshipArbalest",               Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000d96|PERK") ),
            new(Id: "perkMarksmanshipEngineer",               Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000dbf|PERK") ),
            new(Id: "perkSmithingLeather",                    Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000ec4|PERK") ),
            new(Id: "perkSmithingMeltdown",                   Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000edf|PERK") ),
            new(Id: "perkSmithingTradecraft",                 Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000ee0|PERK") ),
            new(Id: "perkSmithingWeavingMill",                Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000ee1|PERK") ),
            new(Id: "perkSmithingSilverRefined",              Formkey: Utils.Helpers.ParseFormKey("Skyrim AE Redone - Core.esm|00000ee4|PERK") )
        ];
}