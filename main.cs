using Mutagen.Bethesda;
using Mutagen.Bethesda.Skyrim;
using Mutagen.Bethesda.Synthesis;

namespace ReProccer;
static class Executor
{
    internal static Lazy<Config.SettingsUI> SettingsUI = new();
    internal static readonly Lazy<Config.General> General = new();

    // entry point
    public static async Task<int> Main(string[] args)
    {
        // TODO: patch name option
        return await SynthesisPipeline.Instance
        .AddPatch<ISkyrimMod, ISkyrimModGetter>(Initialize)
        .SetAutogeneratedSettings("ReProccer Evolved", "settings/settings.json", out SettingsUI)
        .SetTypicalOpen(GameRelease.SkyrimSE, $"{General.Value.PatchName}.esp")
        .Run(args);
    }
}